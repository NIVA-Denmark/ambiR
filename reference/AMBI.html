<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculates AMBI, the AZTI Marine Biotic Index — AMBI • ambiR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates AMBI, the AZTI Marine Biotic Index — AMBI"><meta name="description" content="Matches a list of species counts with the AMBI species list
and calculates the AMBI index."><meta property="og:description" content="Matches a list of species counts with the AMBI species list
and calculates the AMBI index."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ambiR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ambiR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/about-AMBI.html">The AMBI index</a></li>
    <li><a class="dropdown-item" href="../articles/interactive.html">Interactive mode</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/niva-denmark/ambiR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculates AMBI, the AZTI Marine Biotic Index</h1>
      <small class="dont-index">Source: <a href="https://github.com/niva-denmark/ambiR/blob/main/R/AMBI.R" class="external-link"><code>R/AMBI.R</code></a></small>
      <div class="d-none name"><code>AMBI.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Matches a list of species counts with the AMBI species list
and calculates the AMBI index.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AMBI</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_rep <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  var_species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  var_count <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  df_species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_group_AMBI <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  groups_strict <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  format_pct <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  show_class <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Borja, A., Franco, J., Pérez, V. (2000) A marine biotic index to establish the
ecological quality of soft bottom benthos within European estuarine and
coastal environments. Marine Pollution Bulletin 40(12): 1100-1114.
<a href="https://doi.org/10.1016/S0025-326X(00)00061-8" class="external-link">https://doi.org/10.1016/S0025-326X(00)00061-8</a></p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>a dataframe of species observations</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>a vector of column names found in <code>df</code> by which calculations
should be grouped <em>e.g. c("station","date")</em></p></dd>


<dt id="arg-var-rep">var_rep<a class="anchor" aria-label="anchor" href="#arg-var-rep"></a></dt>
<dd><p><em>optional</em> column name in <code>df</code> which contains the name of
the column identifying replicates. If replicates are used,
the AMBI index will be calculated for each replicate before
an average is calculated for each combination of <code>by</code>
variables. If the Shannon diversity index <code>H</code> is calculated
this will be done for species counts collected within <code>by</code>
groups without any consideration of replicates.</p></dd>


<dt id="arg-var-species">var_species<a class="anchor" aria-label="anchor" href="#arg-var-species"></a></dt>
<dd><p>name of the column in <code>df</code> containing species names</p></dd>


<dt id="arg-var-count">var_count<a class="anchor" aria-label="anchor" href="#arg-var-count"></a></dt>
<dd><p>name of the column in <code>df</code> containing count/density/abundance</p></dd>


<dt id="arg-df-species">df_species<a class="anchor" aria-label="anchor" href="#arg-df-species"></a></dt>
<dd><p><em>optional</em> dataframe of user-specified species groups. By default,
the function matches species in <code>df</code> with the official species
list from AZTI. If a dataframe with a user-defined list of
species is provided, then a search for species groups will
also be made in this list. <em>see <a href="#species-matching-and-interactive-mode">Details</a></em>.</p></dd>


<dt id="arg-var-group-ambi">var_group_AMBI<a class="anchor" aria-label="anchor" href="#arg-var-group-ambi"></a></dt>
<dd><p><em>optional</em> name of the column in <code>df_species</code>
containing the groups for the AMBI index calculations. These
should be specified as integer values from 1 to 7. Any other
values will be ignored. If <code>df_species</code> is not specified
then <code>var_group_AMBI</code> will be ignored.</p></dd>


<dt id="arg-groups-strict">groups_strict<a class="anchor" aria-label="anchor" href="#arg-groups-strict"></a></dt>
<dd><p>By default, any user-assigned species group which
conflicts with an AZTI group assignment will be ignored and
the original group remains unchanged. If the argument
<code>groups_strict = FALSE</code> is used then user-assigned groups
will always override AMBI groups in case of conflict.
<em>DO NOT use this option unless you are sure you know what
you are doing! It could invalidate your results.</em></p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>warnings about low numbers of species and/or individuals
are contained in the <code>warnings</code> dataframe. By default
(<code>quiet = FALSE</code>) these warnings are also shown in the console.
If the function is called with the parameter <code>quiet = TRUE</code>
then warnings will not be displayed in the console.</p></dd>


<dt id="arg-interactive">interactive<a class="anchor" aria-label="anchor" href="#arg-interactive"></a></dt>
<dd><p>(default <code>FALSE</code>) if a species name in the input data is not
found in the AZTI species list, then this will be seen in
the output dataframe <code>matched</code>. If <em>interactive</em> mode is
selected, the user will be given the opportunity to assign
<em>manually</em> a species group (<em>I, II, III, IV, V</em>) or to
mark the species as <em>not assigned</em> to a species group (see
details).</p></dd>


<dt id="arg-format-pct">format_pct<a class="anchor" aria-label="anchor" href="#arg-format-pct"></a></dt>
<dd><p>(<em>optional</em>) By default, frequency results including the
fraction of total numbers within each species group are
expressed as real numbers . If this is argument is
given a positive integer value (e.g. <code>format_pct = 2</code>)
then the fractions are expressed as percentages
with the number of digits shown after the decimal point
equal to the number specified. <em>NOTE</em> by formatting as
percentages, values are converted to text and may lose
precision.</p></dd>


<dt id="arg-show-class">show_class<a class="anchor" aria-label="anchor" href="#arg-show-class"></a></dt>
<dd><p>(default <code>TRUE</code>). If <code>TRUE</code> then the <code>AMBI</code> results will
include a column showing the AMBI disturbance classification
<em>Undisturbed</em>, <em>Slightly disturbed</em>, <em>Moderately disturbed</em>,
or <em>Heavily disturbed</em>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of dataframes:</p><ul><li><p><code>AMBI</code> : results of the AMBI index calculations. For each unique
combination of <code>by</code> variables, the following values are calculated:</p><ul><li><p><code>AMBI</code> : the AMBI index value</p></li>
<li><p><code>N</code> : the number of individuals</p></li>
<li><p><code>S</code> : the number of species</p></li>
<li><p><code>H</code> : the Shannon diversity index</p></li>
<li><p><code>fNA</code> : the fraction of individuals <em>not assigned</em>, that is, matched to
a species in the AZTI species with <em>Group 0</em>. Note that this is
different from the number of rows where no match was found. These
are excluded from the totals.</p></li>
</ul></li>
<li><p><code>AMBI_rep</code> : results of the AMBI index calculations <em>per replicate</em>. This
dataframe is present only if the observation data includes replicates and
the user has specified <code>var_rep</code>.</p></li>
<li><p><code>matched</code> : the original dataframe with columns added from the species list.
Contains the following columns:</p><ul><li><p><code>group</code> : showing the species group. Any species/taxa in <code>df</code> which were not
matched will have an <code>NA</code> value in this column.</p></li>
<li><p><code>RA</code> : indicating that the species is
<em>reallocatable</em> according to the AZTI list. That is, it could be re-assigned to
a different species group.</p></li>
<li><p><code>source</code> : this column is included only if a user-specified list was
provided <code>df_species</code>, or if species groups were assigned interactively.
An <em>'I'</em> in this column indicates that the group was assigned interactively.
A <em>'U'</em> shows that the group information came from a user-provided species
list. An <em>NA</em> value indicates that no interactive or user-provided changes
were applied.</p></li>
</ul></li>
<li><p><code>warnings</code> : a dataframe showing warnings for any combination of <code>by</code>
variables a warning where</p><ul><li><p>The percentage of individuals not assigned to a group is higher than 20%</p></li>
<li><p>The (not null) number of species is less than 3</p></li>
<li><p>The (not null) number of individuals is less than 6</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The theory behind the AMBI index calculations and details of the method.</p><div class="section">
<h3 id="ambi-method">AMBI method<a class="anchor" aria-label="anchor" href="#ambi-method"></a></h3>


<p>Species can be matched to one of five groups, the distribution of individuals
between the groups reflecting different levels of stress on the ecosystem.</p><ul><li><p><em>Group I</em>. Species very sensitive to organic enrichment
and present under unpolluted conditions (initial state). They include the
specialist carnivores and some deposit- feeding <em>tubicolous polychaetes</em>.</p></li>
<li><p><em>Group II</em>. Species indifferent to enrichment, always present in low densities with
non-significant variations with time (from initial state, to slight unbalance).
These include suspension feeders, less selective carnivores and scavengers.</p></li>
<li><p><em>Group III</em>. Species tolerant to excess organic matter enrichment. These species
may occur under normal conditions, but their populations are stimulated by
organic enrichment (slight unbalance situations). They are surface
deposit-feeding species, as <em>tubicolous spionids</em>.</p></li>
<li><p><em>Group IV</em>. Second-order opportunistic species (slight to pronounced unbalanced
situations). Mainly small sized <em>polychaetes</em>: subsurface deposit-feeders,
such as <em>cirratulids</em>.</p></li>
<li><p><em>Group V</em>. First-order opportunistic species (pronounced unbalanced
situations). These are deposit- feeders, which proliferate in reduced
sediments.</p></li>
</ul><p>The distribution of these ecological groups, according to their sensitivity to
pollution stress, provides a BI with eight levels, from 0 to 7</p>
<p><em>Biotic Coefficient = (0.0 * GI + l.5 * GII + 3.0 * GIII + 4.5 * GIV + 6.0 * GV)</em></p>
<p>where:</p>
<p><em>Gn := fraction of individuals in Group n [I, II, III, IV, V]</em></p>
<p>Under certain circumstances, the AMBI index should not be used:</p><ul><li><p>The percentage of individuals not assigned to a group is higher than 20%</p></li>
<li><p>The (not null) number of species is less than 3</p></li>
<li><p>The (not null) number of individuals is less than 6</p></li>
</ul><p>In these cases the function will still perform the calculations but will
also return a warning.(see below)</p>
</div>

<div class="section">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a></h3>


<p>The output of the function consists of a list of three dataframes:</p><ul><li><p><code>AMBI</code> containing the calculated <code>AMBI</code> index, as well as other information.</p></li>
<li><p><code>matched</code> showing the species matches used</p></li>
<li><p><code>warnings</code> containing any warnings generated regarding numbers of of species
or numbers of individuals</p></li>
</ul></div>

<div class="section">
<h3 id="species-matching-and-interactive-mode">Species matching and <em>interactive</em> mode<a class="anchor" aria-label="anchor" href="#species-matching-and-interactive-mode"></a></h3>


<p>The function will check for a species list supplied in the function call
using the argument <code>df_species</code>, if this is specified. The function will
also search for names in the AMBI standard list. After this, if no match
is found in either, then the species will be recorded with a an <code>NA</code>value
for species group and will be ignored in calculations.</p>
<p>By calling the function once and then checking the output from this first
function call, the user can identify species names which were  not matched.
Then, if necessary, they can provide or update a dataframe with a list of
user-defined species group assignments, before running the function a
second time.</p><div class="section">
<h4 id="conflicts">conflicts<a class="anchor" aria-label="anchor" href="#conflicts"></a></h4>


<p>If there is a conflict between a user-provided group assignment for a species
and the group specified in the AMBI species group information, only one of
them will be selected. The outcome depends on a number of things:</p><ul><li><p>some species in the AMBI list are considered <em>reallocatable</em> (RA) - that is,
there can be disagreement about which species group they should belong to.
For these species, any user-specified groups will replace the default group.</p></li>
<li><p>if a species is not <em>reallocatable</em>, then any user-specified groups will
<em>by default</em> be ignored. However, if the function is called with the argument
<code>groups_strict = FALSE</code> then the user-specified groups will override AMBI
species groups.</p></li>
</ul><p>Any conflicts and their outcomes will be recorded in
the <code>matched</code> output.</p>
</div>

<div class="section">
<h4 id="interactive-mode"><em>interactive</em> mode<a class="anchor" aria-label="anchor" href="#interactive-mode"></a></h4>


<p><em>TO DO: example needed!</em></p>
<p>If the function is called with the argument <code>interactive = TRUE</code> then the user
will be asked to assign a species group (<em>I, II, III, IV, V</em>) for any species
names which were not identified. The user does this by typing <em>1, 2, 3, 4</em> or
<em>5</em> and pressing <em>Enter</em>. Alternatively, the user can type <em>0</em> to mark the species
as recognized but not assigned to a group. By typing <em>Enter</em> without
any number the species will be recorded as unidentified (<code>NA</code>). This is the
same result which would have been returned when calling the function in
non-interactive mode. There are two other options: <em>s</em> will display a list of
10 species names which occur close to the unrecognized name when names are sorted
in alphabetical order. Entering <em>s</em> a second time will display the next 10 names,
and so on. Finally, entering <em>x</em> will abort the interactive species assignment.
Any species groups assigned manually at this point wil be discarded and the
calculations will process as in the non-interactive mode.</p>
<p>Any user-provided group information will be recorded in the <code>matched</code> results.</p>
</div>


</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example (1) - using test data included with package</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">AMBI</span><span class="op">(</span><span class="va">test_data</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"station"</span><span class="op">)</span>, var_rep<span class="op">=</span><span class="st">"replicate"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $AMBI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station  AMBI     H     S   fNA     N     I    II   III     IV      V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>       1  1.48  1.80     6     0    16 0.125 0.75  0.125 0      0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>       2  1.89  3.54    22     0    80 0.4   0.138 0.3   0.15   0.012<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>       3  4.12  2.50     9     0    24 0     0.125 0.292 0.083<span style="text-decoration: underline;">3</span> 0.5   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: Disturbance &lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $AMBI_rep</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate  AMBI     S   fNA     N     I     II   III    IV      V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>       1 a          1.8      3     0     5 0     0.8    0.2   0     0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>       1 b          1.5      3     0     7 0.143 0.714  0.143 0     0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>       1 c          1.12     2     0     4 0.25  0.75   0     0     0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>       2 a          1.88    12     0    32 0.406 0.156  0.219 0.219 0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>       2 b          2.13    12     0    19 0.316 0.158  0.368 0.105 0.052<span style="text-decoration: underline;">6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>       2 c          1.66    10     0    29 0.448 0.103  0.345 0.103 0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span>       3 a          3.5      5     0     6 0     0.333  0.167 0.333 0.167 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span>       3 b          4.75     6     0    18 0     0.055<span style="text-decoration: underline;">6</span> 0.333 0     0.611 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $matched</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 53 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    station replicate species             count group    RA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>       1 a         Cumopsis fagei          2     2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>       1 a         Diogenes pugilator      2     2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>       1 a         Paradoneis armata       1     3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>       1 b         Bathyporeia elegans     1     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>       1 b         Diogenes pugilator      5     2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>       1 b         Dispio uncinata         1     3     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>       1 c         Astarte sp.             1     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>       1 c         Diogenes pugilator      3     2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>       2 a         Cumopsis fagei          1     2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>       2 a         Glycera tridactyla      2     2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 43 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example (2)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>station <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"2"</span>,<span class="st">"2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Acidostoma neglectum"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"Acrocirrus validus"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"Acteocina bullata"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"Austrohelice crassa"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"Capitella nonatoi"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">AMBI</span><span class="op">(</span><span class="va">df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"station"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>station 1: The percentage of individuals not assigned to a group is higher than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 20% [33.3%].</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>station 1: The (not null) number of species is less than 3 [2].</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>station 1: The (not null) number of individuals is less than 6 [4].</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $AMBI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station  AMBI     H     S   fNA     N     I    II   III    IV     V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1         4.5 0.918     2 0.333     6 0         0     0     1 0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2         4   1.51      3 0        15 0.333     0     0     0 0.667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: Disturbance &lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $matched</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station              species count group RA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 Acidostoma neglectum     2     0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1   Acrocirrus validus     4     4  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       2    Acteocina bullata     5     1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       2  Austrohelice crassa     3     5  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       2    Capitella nonatoi     7     5  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $warnings</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station warning                                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1       The percentage of individuals not assigned to a group is higher than …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1       The (not null) number of species is less than 3 [2].                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1       The (not null) number of individuals is less than 6 [4].              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example (3) - conflict with AZTI species group</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_user</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>              species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cumopsis fagei"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">AMBI</span><span class="op">(</span><span class="va">test_data</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"station"</span><span class="op">)</span>, var_rep<span class="op">=</span><span class="st">"replicate"</span>, df_species<span class="op">=</span><span class="va">df_user</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 1 user-assigned group in conflict with AMBI was ignored:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> <span style="font-style: italic;">Cumopsis fagei</span> (II)→(I)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $AMBI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station  AMBI     H     S   fNA     N     I    II   III     IV      V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>       1  1.48  1.80     6     0    16 0.125 0.75  0.125 0      0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>       2  1.89  3.54    22     0    80 0.4   0.138 0.3   0.15   0.012<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>       3  4.12  2.50     9     0    24 0     0.125 0.292 0.083<span style="text-decoration: underline;">3</span> 0.5   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: Disturbance &lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $AMBI_rep</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station replicate  AMBI     S   fNA     N     I     II   III    IV      V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>       1 a          1.8      3     0     5 0     0.8    0.2   0     0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>       1 b          1.5      3     0     7 0.143 0.714  0.143 0     0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>       1 c          1.12     2     0     4 0.25  0.75   0     0     0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>       2 a          1.88    12     0    32 0.406 0.156  0.219 0.219 0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>       2 b          2.13    12     0    19 0.316 0.158  0.368 0.105 0.052<span style="text-decoration: underline;">6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>       2 c          1.66    10     0    29 0.448 0.103  0.345 0.103 0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span>       3 a          3.5      5     0     6 0     0.333  0.167 0.333 0.167 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span>       3 b          4.75     6     0    18 0     0.055<span style="text-decoration: underline;">6</span> 0.333 0     0.611 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $matched</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 53 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    station replicate species             count group source    RA group_note    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>       1 a         Cumopsis fagei          2     2 <span style="color: #BB0000;">NA</span>         0 ignored user …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>       1 a         Diogenes pugilator      2     2 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>       1 a         Paradoneis armata       1     3 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>       1 b         Bathyporeia elegans     1     1 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>       1 b         Diogenes pugilator      5     2 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>       1 b         Dispio uncinata         1     3 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>       1 c         Astarte sp.             1     1 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>       1 c         Diogenes pugilator      3     2 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>       2 a         Cumopsis fagei          1     2 <span style="color: #BB0000;">NA</span>         0 ignored user …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>       2 a         Glycera tridactyla      2     2 <span style="color: #BB0000;">NA</span>         0 <span style="color: #BB0000;">NA</span>            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 43 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ciarán J. Murray, Ángel Borja, Sarai Pouso, Iñigo Muxika, Joxe Mikel Garmendia, Jørgen L. S. Hansen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

